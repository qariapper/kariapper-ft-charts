<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Kariapper Family Tree – up to 3 generations</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<script src="https://d3js.org/d3.v7.min.js"></script>
<style>
 body{margin:0;font-family:"Segoe UI",sans-serif}
 h1{text-align:center;margin:12px 0}
 #tree_div{width:100%;height:calc(100vh - 50px);overflow:auto}
 svg{display:block;width:100%;height:auto}
 .trunk,.branch{fill:none;stroke:#888;stroke-width:1.5px;stroke-linecap:round}
 .node-rect{rx:4;ry:4;filter:drop-shadow(2px 2px 2px rgba(0,0,0,.15))}
 .gen1{fill:#eceff4;stroke:#4c566a}
 .gen2{fill:#e5e9f0;stroke:#3b4252}
 .gen3{fill:#d8dee9;stroke:#2e3440}
 .node-text{pointer-events:none;text-anchor:start;dominant-baseline:central}
 .node{cursor:pointer}
</style>
</head>
<body>
<h1>Kariapper Family Tree – up to 3 generations – ver 26</h1>
<div id="tree_div">Loading…</div>

<script>
(async function () {

/* ────────── 1. FETCH SHEET ────────── */
const sheetID='1BE7PJAJs3QxHnOsb1z5cKnGHdjQCR8IksorMcAm7Fx8';
const raw = await fetch(
  `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?gid=0&headers=1&tqx=out:json`
).then(r
