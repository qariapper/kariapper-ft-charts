<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Kariapper Family Tree (3 Generations)Again</title>
  <script src="https://www.gstatic.com/charts/loader.js"></script>
  <style>
    html, body { margin:0; padding:0; height:100%; }
    #tree_div { width:100%; height:100%; overflow:auto; }
    h1 { text-align:center; margin:12px 0; }
  </style>
  <script>
    // load OrgChart package
    google.charts.load('current', {packages:['orgchart']});
    google.charts.setOnLoadCallback(drawChart);

    function drawChart() {
      // NOTE: replace the sheet name if yours is not "MasterSheet"
      const spreadsheetURL =
        'https://docs.google.com/spreadsheets/d/' +
        '1BE7PJAJs3QxHnOsb1z5cKnGHdjQCR8IksorMcAm7Fx8' +
        '/gviz/tq?sheet=Master&headers=1';
      
      const query = new google.visualization.Query(spreadsheetURL);

      // select D (dID), P (Father_dID), C (Full Name) where AA (Generation) ≤ 3
      query.setQuery("select D,P,C where AA <= 3");
      query.send(response => {
        if (response.isError()) {
          document.getElementById('tree_div').innerText =
            'Error loading data: ' + response.getMessage();
          return;
        }
        const data = response.getDataTable();
        const chart = new google.visualization.OrgChart(
          document.getElementById('tree_div')
        );
        chart.draw(data, {
          allowHtml:     true,
          allowCollapse: true,
          orientation:  'vertical'
        });
      });
    }
  </script>
</head>
<body>
  <h1>Kariapper Family Tree – up to 3 generations Again</h1>
  <div id="tree_div"></div>
</body>
</html>
